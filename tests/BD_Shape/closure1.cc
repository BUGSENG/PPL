/* Test shortest path closure.
   Copyright (C) 2001-2005 Roberto Bagnara <bagnara@cs.unipr.it>

This file is part of the Parma Polyhedra Library (PPL).

The PPL is free software; you can redistribute it and/or modify it
under the terms of the GNU General Public License as published by the
Free Software Foundation; either version 2 of the License, or (at your
option) any later version.

The PPL is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software Foundation,
Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02111-1307, USA.

For the most up-to-date information see the Parma Polyhedra Library
site: http://www.cs.unipr.it/ppl/ . */

#include "ppl_test.hh"

using namespace std;
using namespace Parma_Polyhedra_Library;

#ifndef NOISY
#define NOISY 0
#endif

#define x(d) Variable(d)

namespace {

struct Edge {
  unsigned int from;
  unsigned int to;
  unsigned long distance;
};

Edge montana[] = {
  { 0, 1, 26107 },
  { 1, 0, 26107 },
  { 2, 0, 70187 },
  { 0, 2, 70187 },
  { 2, 3, 3197 },
  { 3, 2, 3197 },
  { 4, 2, 1771 },
  { 2, 4, 1771 },
  { 5, 6, 24741 },
  { 6, 5, 24741 },
  { 0, 7, 24080 },
  { 7, 0, 24080 },
  { 6, 8, 49232 },
  { 8, 6, 49232 },
  { 9, 10, 8359 },
  { 10, 9, 8359 },
  { 4, 11, 21051 },
  { 11, 4, 21051 },
  { 12, 7, 16520 },
  { 7, 12, 16520 },
  { 13, 14, 17293 },
  { 14, 13, 17293 },
  { 6, 15, 17963 },
  { 15, 6, 17963 },
  { 15, 16, 2113 },
  { 16, 15, 2113 },
  { 17, 9, 13810 },
  { 9, 17, 13810 },
  { 11, 18, 12299 },
  { 18, 11, 12299 },
  { 18, 17, 9781 },
  { 17, 18, 9781 },
  { 10, 19, 15701 },
  { 19, 10, 15701 },
  { 17, 19, 3723 },
  { 19, 17, 3723 },
  { 12, 4, 85550 },
  { 4, 12, 85550 },
  { 20, 18, 16694 },
  { 18, 20, 16694 },
  { 21, 22, 6499 },
  { 22, 21, 6499 },
  { 23, 16, 19537 },
  { 16, 23, 19537 },
  { 24, 25, 11813 },
  { 25, 24, 11813 },
  { 22, 26, 75854 },
  { 26, 22, 75854 },
  { 26, 27, 1135 },
  { 27, 26, 1135 },
  { 28, 29, 18257 },
  { 29, 28, 18257 },
  { 30, 23, 11237 },
  { 23, 30, 11237 },
  { 30, 31, 1121 },
  { 31, 30, 1121 },
  { 32, 27, 4381 },
  { 27, 32, 4381 },
  { 26, 32, 4517 },
  { 32, 26, 4517 },
  { 32, 33, 1501 },
  { 33, 32, 1501 },
  { 31, 34, 2210 },
  { 34, 31, 2210 },
  { 35, 36, 18923 },
  { 36, 35, 18923 },
  { 35, 28, 74092 },
  { 28, 35, 74092 },
  { 25, 37, 18146 },
  { 37, 25, 18146 },
  { 38, 30, 6207 },
  { 30, 38, 6207 },
  { 34, 38, 5448 },
  { 38, 34, 5448 },
  { 39, 40, 41824 },
  { 40, 39, 41824 },
  { 34, 37, 34717 },
  { 37, 34, 34717 },
  { 41, 42, 29671 },
  { 42, 41, 29671 },
  { 33, 43, 76808 },
  { 43, 33, 76808 },
  { 41, 20, 45130 },
  { 20, 41, 45130 },
  { 44, 42, 40535 },
  { 42, 44, 40535 },
  { 45, 44, 3617 },
  { 44, 45, 3617 },
  { 37, 46, 28299 },
  { 46, 37, 28299 },
  { 47, 44, 28857 },
  { 44, 47, 28857 },
  { 48, 38, 30274 },
  { 38, 48, 30274 },
  { 48, 46, 43836 },
  { 46, 48, 43836 },
  { 49, 50, 53741 },
  { 50, 49, 53741 },
  { 21, 51, 106697 },
  { 51, 21, 106697 },
  { 52, 43, 116929 },
  { 43, 52, 116929 },
  { 53, 51, 1990 },
  { 51, 53, 1990 },
  { 54, 51, 3045 },
  { 51, 54, 3045 },
  { 53, 54, 2477 },
  { 54, 53, 2477 },
  { 52, 55, 3881 },
  { 55, 52, 3881 },
  { 50, 56, 33459 },
  { 56, 50, 33459 },
  { 57, 55, 1992 },
  { 55, 57, 1992 },
  { 52, 57, 4894 },
  { 57, 52, 4894 },
  { 55, 58, 21039 },
  { 58, 55, 21039 },
  { 59, 46, 31633 },
  { 46, 59, 31633 },
  { 46, 60, 33357 },
  { 60, 46, 33357 },
  { 61, 41, 41190 },
  { 41, 61, 41190 },
  { 62, 28, 60657 },
  { 28, 62, 60657 },
  { 63, 59, 19466 },
  { 59, 63, 19466 },
  { 48, 64, 29803 },
  { 64, 48, 29803 },
  { 62, 65, 11902 },
  { 65, 62, 11902 },
  { 64, 63, 15047 },
  { 63, 64, 15047 },
  { 60, 66, 37241 },
  { 66, 60, 37241 },
  { 59, 67, 8970 },
  { 67, 59, 8970 },
  { 66, 67, 515 },
  { 67, 66, 515 },
  { 68, 69, 470 },
  { 69, 68, 470 },
  { 67, 63, 20036 },
  { 63, 67, 20036 },
  { 70, 62, 4707 },
  { 62, 70, 4707 },
  { 65, 70, 10027 },
  { 70, 65, 10027 },
  { 71, 58, 16323 },
  { 58, 71, 16323 },
  { 57, 71, 21570 },
  { 71, 57, 21570 },
  { 43, 72, 82600 },
  { 72, 43, 82600 },
  { 72, 33, 62668 },
  { 33, 72, 62668 },
  { 73, 53, 58630 },
  { 53, 73, 58630 },
  { 69, 74, 40919 },
  { 74, 69, 40919 },
  { 75, 64, 16577 },
  { 64, 75, 16577 },
  { 73, 76, 3835 },
  { 76, 73, 3835 },
  { 76, 75, 2351 },
  { 75, 76, 2351 },
  { 77, 78, 1022 },
  { 78, 77, 1022 },
  { 77, 76, 3099 },
  { 76, 77, 3099 },
  { 79, 80, 5560 },
  { 80, 79, 5560 },
  { 80, 75, 2145 },
  { 75, 80, 2145 },
  { 81, 66, 27042 },
  { 66, 81, 27042 },
  { 60, 81, 29347 },
  { 81, 60, 29347 },
  { 82, 80, 36275 },
  { 80, 82, 36275 },
  { 82, 83, 1964 },
  { 83, 82, 1964 },
  { 83, 82, 1782 },
  { 82, 83, 1782 },
  { 84, 61, 37580 },
  { 61, 84, 37580 },
  { 50, 84, 98462 },
  { 84, 50, 98462 },
  { 85, 86, 32029 },
  { 86, 85, 32029 },
  { 87, 84, 8876 },
  { 84, 87, 8876 },
  { 88, 54, 73817 },
  { 54, 88, 73817 },
  { 89, 87, 1626 },
  { 87, 89, 1626 },
  { 89, 84, 9824 },
  { 84, 89, 9824 },
  { 90, 87, 4141 },
  { 87, 90, 4141 },
  { 90, 91, 1222 },
  { 91, 90, 1222 },
  { 91, 89, 3635 },
  { 89, 91, 3635 },
  { 92, 91, 713 },
  { 91, 92, 713 },
  { 93, 90, 1940 },
  { 90, 93, 1940 },
  { 94, 93, 7200 },
  { 93, 94, 7200 },
  { 95, 92, 2220 },
  { 92, 95, 2220 },
  { 91, 95, 1894 },
  { 95, 91, 1894 },
  { 81, 96, 37828 },
  { 96, 81, 37828 },
  { 97, 94, 52436 },
  { 94, 97, 52436 },
  { 98, 97, 39449 },
  { 97, 98, 39449 },
  { 98, 96, 43703 },
  { 96, 98, 43703 },
  { 99, 83, 37656 },
  { 83, 99, 37656 },
  { 81, 99, 26309 },
  { 99, 81, 26309 },
  { 100, 101, 15784 },
  { 101, 100, 15784 },
  { 100, 68, 51891 },
  { 68, 100, 51891 },
  { 102, 95, 14293 },
  { 95, 102, 14293 },
  { 72, 103, 50496 },
  { 103, 72, 50496 },
  { 104, 100, 3793 },
  { 100, 104, 3793 },
  { 104, 105, 12475 },
  { 105, 104, 12475 },
  { 106, 107, 1785 },
  { 107, 106, 1785 },
  { 108, 94, 71128 },
  { 94, 108, 71128 },
  { 109, 110, 12968 },
  { 110, 109, 12968 },
  { 109, 111, 374 },
  { 111, 109, 374 },
  { 112, 113, 47521 },
  { 113, 112, 47521 },
  { 111, 113, 28708 },
  { 113, 111, 28708 },
  { 114, 106, 53573 },
  { 106, 114, 53573 },
  { 115, 99, 41102 },
  { 99, 115, 41102 },
  { 115, 116, 624 },
  { 116, 115, 624 },
  { 117, 103, 26509 },
  { 103, 117, 26509 },
  { 111, 117, 53396 },
  { 117, 111, 53396 },
  { 118, 98, 49411 },
  { 98, 118, 49411 },
  { 119, 108, 34547 },
  { 108, 119, 34547 },
  { 120, 116, 8467 },
  { 116, 120, 8467 },
  { 121, 115, 8530 },
  { 115, 121, 8530 },
  { 121, 120, 1074 },
  { 120, 121, 1074 },
  { 120, 122, 1135 },
  { 122, 120, 1135 },
  { 122, 123, 677 },
  { 123, 122, 677 },
  { 124, 120, 628 },
  { 120, 124, 628 },
  { 124, 122, 904 },
  { 122, 124, 904 },
  { 122, 125, 526 },
  { 125, 122, 526 },
  { 123, 125, 499 },
  { 125, 123, 499 },
  { 126, 123, 17201 },
  { 123, 126, 17201 },
  { 127, 124, 591 },
  { 124, 127, 591 },
  { 128, 121, 1457 },
  { 121, 128, 1457 },
  { 127, 128, 1919 },
  { 128, 127, 1919 },
  { 129, 119, 12585 },
  { 119, 129, 12585 },
  { 130, 102, 48614 },
  { 102, 130, 48614 },
  { 131, 129, 3967 },
  { 129, 131, 3967 },
  { 129, 131, 3810 },
  { 131, 129, 3810 },
  { 104, 132, 70564 },
  { 132, 104, 70564 },
  { 132, 133, 2859 },
  { 133, 132, 2859 },
  { 133, 107, 75000 },
  { 107, 133, 75000 },
  { 132, 134, 1756 },
  { 134, 132, 1756 },
  { 133, 134, 1663 },
  { 134, 133, 1663 },
  { 135, 85, 97258 },
  { 85, 135, 97258 },
  { 136, 134, 3293 },
  { 134, 136, 3293 },
  { 136, 133, 1993 },
  { 133, 136, 1993 },
  { 108, 137, 42291 },
  { 137, 108, 42291 },
  { 130, 137, 79411 },
  { 137, 130, 79411 },
  { 132, 138, 49082 },
  { 138, 132, 49082 },
  { 139, 138, 478 },
  { 138, 139, 478 },
  { 135, 140, 15319 },
  { 140, 135, 15319 },
  { 138, 141, 2226 },
  { 141, 138, 2226 },
  { 128, 142, 49923 },
  { 142, 128, 49923 },
  { 143, 128, 41229 },
  { 128, 143, 41229 },
  { 141, 144, 10952 },
  { 144, 141, 10952 },
  { 145, 146, 10144 },
  { 146, 145, 10144 },
  { 137, 145, 40301 },
  { 145, 137, 40301 },
  { 142, 140, 55256 },
  { 140, 142, 55256 },
  { 145, 147, 2187 },
  { 147, 145, 2187 },
  { 135, 148, 91459 },
  { 148, 135, 91459 },
  { 149, 113, 50508 },
  { 113, 149, 50508 },
  { 146, 150, 6813 },
  { 150, 146, 6813 },
  { 147, 150, 7362 },
  { 150, 147, 7362 },
  { 151, 136, 94818 },
  { 136, 151, 94818 },
  { 150, 152, 16474 },
  { 152, 150, 16474 },
  { 153, 117, 58823 },
  { 117, 153, 58823 },
  { 154, 152, 5341 },
  { 152, 154, 5341 },
  { 154, 155, 2924 },
  { 155, 154, 2924 },
  { 156, 157, 1090 },
  { 157, 156, 1090 },
  { 155, 156, 508 },
  { 156, 155, 508 },
  { 156, 158, 588 },
  { 158, 156, 588 },
  { 154, 158, 3556 },
  { 158, 154, 3556 },
  { 159, 157, 2546 },
  { 157, 159, 2546 },
  { 158, 159, 2760 },
  { 159, 158, 2760 },
  { 159, 160, 2349 },
  { 160, 159, 2349 },
  { 159, 161, 588 },
  { 161, 159, 588 },
  { 158, 161, 3108 },
  { 161, 158, 3108 },
  { 162, 147, 32119 },
  { 147, 162, 32119 },
  { 163, 130, 56092 },
  { 130, 163, 56092 },
  { 164, 160, 35577 },
  { 160, 164, 35577 },
  { 165, 164, 616 },
  { 164, 165, 616 },
  { 165, 166, 301 },
  { 166, 165, 301 },
  { 167, 166, 14397 },
  { 166, 167, 14397 },
  { 168, 164, 7614 },
  { 164, 168, 7614 },
  { 143, 169, 46639 },
  { 169, 143, 46639 },
  { 168, 169, 3365 },
  { 169, 168, 3365 },
  { 165, 168, 7901 },
  { 168, 165, 7901 },
  { 161, 167, 28238 },
  { 167, 161, 28238 },
  { 170, 142, 41573 },
  { 142, 170, 41573 },
  { 169, 171, 1951 },
  { 171, 169, 1951 },
  { 171, 168, 4866 },
  { 168, 171, 4866 },
  { 170, 171, 31880 },
  { 171, 170, 31880 },
  { 172, 170, 1631 },
  { 170, 172, 1631 },
  { 170, 173, 5587 },
  { 173, 170, 5587 },
  { 152, 174, 23767 },
  { 174, 152, 23767 },
  { 175, 140, 44743 },
  { 140, 175, 44743 },
  { 176, 174, 1200 },
  { 174, 176, 1200 },
  { 177, 151, 12428 },
  { 151, 177, 12428 },
  { 178, 151, 10620 },
  { 151, 178, 10620 },
  { 173, 172, 6169 },
  { 172, 173, 6169 },
  { 177, 178, 2217 },
  { 178, 177, 2217 },
  { 179, 177, 1739 },
  { 177, 179, 1739 },
  { 180, 178, 4048 },
  { 178, 180, 4048 },
  { 180, 179, 2129 },
  { 179, 180, 2129 },
  { 181, 180, 4739 },
  { 180, 181, 4739 },
  { 181, 182, 3794 },
  { 182, 181, 3794 },
  { 183, 184, 43755 },
  { 184, 183, 43755 },
  { 171, 185, 19130 },
  { 185, 171, 19130 },
  { 172, 185, 15623 },
  { 185, 172, 15623 },
  { 186, 166, 16853 },
  { 166, 186, 16853 },
  { 186, 167, 10362 },
  { 167, 186, 10362 },
  { 187, 188, 744 },
  { 188, 187, 744 },
  { 189, 174, 12470 },
  { 174, 189, 12470 },
  { 190, 139, 57772 },
  { 139, 190, 57772 },
  { 178, 190, 131884 },
  { 190, 178, 131884 },
  { 191, 148, 55645 },
  { 148, 191, 55645 },
  { 192, 190, 21532 },
  { 190, 192, 21532 },
  { 193, 191, 2060 },
  { 191, 193, 2060 },
  { 191, 194, 4017 },
  { 194, 191, 4017 },
  { 193, 194, 5936 },
  { 194, 193, 5936 },
  { 195, 186, 19512 },
  { 186, 195, 19512 },
  { 196, 197, 7981 },
  { 197, 196, 7981 },
  { 198, 199, 1408 },
  { 199, 198, 1408 },
  { 197, 198, 12173 },
  { 198, 197, 12173 },
  { 197, 200, 45802 },
  { 200, 197, 45802 },
  { 185, 200, 25382 },
  { 200, 185, 25382 },
  { 201, 202, 4200 },
  { 202, 201, 4200 },
  { 203, 202, 6119 },
  { 202, 203, 6119 },
  { 203, 204, 3876 },
  { 204, 203, 3876 },
  { 205, 203, 1465 },
  { 203, 205, 1465 },
  { 205, 202, 7722 },
  { 202, 205, 7722 },
  { 206, 207, 43443 },
  { 207, 206, 43443 },
  { 208, 206, 54989 },
  { 206, 208, 54989 },
  { 209, 207, 37152 },
  { 207, 209, 37152 },
  { 210, 211, 62589 },
  { 211, 210, 62589 },
  { 212, 209, 5650 },
  { 209, 212, 5650 },
  { 212, 213, 3043 },
  { 213, 212, 3043 },
  { 214, 211, 1979 },
  { 211, 214, 1979 },
  { 215, 214, 642 },
  { 214, 215, 642 },
  { 214, 216, 7036 },
  { 216, 214, 7036 },
  { 217, 215, 2296 },
  { 215, 217, 2296 },
  { 217, 216, 4238 },
  { 216, 217, 4238 },
  { 218, 215, 869 },
  { 215, 218, 869 },
  { 219, 218, 454 },
  { 218, 219, 454 },
  { 194, 220, 62140 },
  { 220, 194, 62140 },
  { 221, 222, 14208 },
  { 222, 221, 14208 },
  { 223, 209, 47376 },
  { 209, 223, 47376 },
  { 224, 221, 5291 },
  { 221, 224, 5291 },
  { 224, 225, 1125 },
  { 225, 224, 1125 },
  { 200, 226, 20359 },
  { 226, 200, 20359 },
  { 227, 195, 36389 },
  { 195, 227, 36389 },
  { 227, 228, 2326 },
  { 228, 227, 2326 },
  { 229, 230, 30571 },
  { 230, 229, 30571 },
  { 228, 229, 1247 },
  { 229, 228, 1247 },
  { 224, 231, 13266 },
  { 231, 224, 13266 },
  { 231, 225, 13706 },
  { 225, 231, 13706 },
  { 232, 233, 36776 },
  { 233, 232, 36776 },
  { 232, 223, 20315 },
  { 223, 232, 20315 },
  { 234, 227, 3060 },
  { 227, 234, 3060 },
  { 234, 228, 1424 },
  { 228, 234, 1424 },
  { 235, 229, 1518 },
  { 229, 235, 1518 },
  { 236, 232, 2831 },
  { 232, 236, 2831 },
  { 237, 234, 990 },
  { 234, 237, 990 },
  { 235, 237, 987 },
  { 237, 235, 987 },
  { 238, 232, 1212 },
  { 232, 238, 1212 },
  { 238, 236, 2944 },
  { 236, 238, 2944 },
  { 223, 239, 40838 },
  { 239, 223, 40838 },
  { 226, 195, 63210 },
  { 195, 226, 63210 },
  { 240, 235, 4671 },
  { 235, 240, 4671 },
  { 240, 184, 89839 },
  { 184, 240, 89839 },
  { 240, 237, 5315 },
  { 237, 240, 5315 },
  { 241, 190, 46048 },
  { 190, 241, 46048 },
  { 242, 224, 16692 },
  { 224, 242, 16692 },
  { 243, 197, 47527 },
  { 197, 243, 47527 },
  { 244, 243, 4304 },
  { 243, 244, 4304 },
  { 245, 236, 19193 },
  { 236, 245, 19193 },
  { 240, 246, 19960 },
  { 246, 240, 19960 },
  { 246, 247, 19049 },
  { 247, 246, 19049 },
  { 248, 245, 37991 },
  { 245, 248, 37991 },
  { 245, 249, 9506 },
  { 249, 245, 9506 },
  { 238, 239, 130070 },
  { 239, 238, 130070 },
  { 250, 242, 23760 },
  { 242, 250, 23760 },
  { 251, 220, 64146 },
  { 220, 251, 64146 },
  { 252, 180, 101052 },
  { 180, 252, 101052 },
  { 252, 253, 106482 },
  { 253, 252, 106482 },
  { 249, 254, 15312 },
  { 254, 249, 15312 },
  { 255, 254, 1848 },
  { 254, 255, 1848 },
  { 255, 249, 15433 },
  { 249, 255, 15433 },
  { 243, 256, 40215 },
  { 256, 243, 40215 },
  { 226, 257, 53003 },
  { 257, 226, 53003 },
  { 258, 259, 17844 },
  { 259, 258, 17844 },
  { 260, 251, 26153 },
  { 251, 260, 26153 },
  { 261, 250, 27493 },
  { 250, 261, 27493 },
  { 262, 263, 8960 },
  { 263, 262, 8960 },
  { 263, 257, 35974 },
  { 257, 263, 35974 },
  { 264, 250, 36910 },
  { 250, 264, 36910 },
  { 265, 266, 11522 },
  { 266, 265, 11522 },
  { 267, 263, 10042 },
  { 263, 267, 10042 },
  { 268, 267, 15368 },
  { 267, 268, 15368 },
  { 269, 267, 4352 },
  { 267, 269, 4352 },
  { 270, 255, 27224 },
  { 255, 270, 27224 },
  { 271, 272, 37072 },
  { 272, 271, 37072 },
  { 273, 272, 88300 },
  { 272, 273, 88300 },
  { 274, 273, 4360 },
  { 273, 274, 4360 },
  { 213, 275, 594 },
  { 275, 213, 594 },
  { 157, 276, 1512 },
  { 276, 157, 1512 },
  { 276, 155, 822 },
  { 155, 276, 822 },
  { 78, 73, 786 },
  { 73, 78, 786 },
  { 77, 79, 1101 },
  { 79, 77, 1101 },
  { 77, 277, 5612 },
  { 277, 77, 5612 },
  { 78, 277, 7173 },
  { 277, 78, 7173 },
  { 86, 79, 5844 },
  { 79, 86, 5844 },
  { 277, 86, 1231 },
  { 86, 277, 1231 },
  { 93, 92, 1432 },
  { 92, 93, 1432 },
  { 278, 102, 50355 },
  { 102, 278, 50355 },
  { 257, 279, 10476 },
  { 279, 257, 10476 },
  { 254, 280, 26691 },
  { 280, 254, 26691 },
  { 281, 282, 8716 },
  { 282, 281, 8716 },
  { 14, 283, 50509 },
  { 283, 14, 50509 },
  { 19, 284, 136631 },
  { 284, 19, 136631 },
  { 283, 284, 27347 },
  { 284, 283, 27347 },
  { 285, 283, 24916 },
  { 283, 285, 24916 },
  { 284, 282, 96765 },
  { 282, 284, 96765 },
  { 10, 282, 83354 },
  { 282, 10, 83354 },
  { 11, 9, 7693 },
  { 9, 11, 7693 },
  { 286, 15, 2499 },
  { 15, 286, 2499 },
  { 286, 16, 1714 },
  { 16, 286, 1714 },
  { 286, 287, 76813 },
  { 287, 286, 76813 },
  { 287, 21, 106167 },
  { 21, 287, 106167 },
  { 288, 12, 19628 },
  { 12, 288, 19628 },
  { 289, 288, 6143 },
  { 288, 289, 6143 },
  { 289, 24, 42827 },
  { 24, 289, 42827 },
  { 8, 289, 58009 },
  { 289, 8, 58009 },
  { 16, 8, 38568 },
  { 8, 16, 38568 },
  { 23, 24, 50677 },
  { 24, 23, 50677 },
  { 288, 7, 21879 },
  { 7, 288, 21879 },
  { 287, 51, 71962 },
  { 51, 287, 71962 },
  { 22, 290, 64728 },
  { 290, 22, 64728 },
  { 291, 27, 61841 },
  { 27, 291, 61841 },
  { 43, 292, 74556 },
  { 292, 43, 74556 },
  { 40, 69, 58951 },
  { 69, 40, 58951 },
  { 62, 68, 86414 },
  { 68, 62, 86414 },
  { 58, 65, 62448 },
  { 65, 58, 62448 },
  { 40, 35, 5391 },
  { 35, 40, 5391 },
  { 55, 293, 76299 },
  { 293, 55, 76299 },
  { 107, 104, 123160 },
  { 104, 107, 123160 },
  { 106, 70, 59024 },
  { 70, 106, 59024 },
  { 71, 114, 77752 },
  { 114, 71, 77752 },
  { 294, 117, 169936 },
  { 117, 294, 169936 },
  { 295, 294, 65070 },
  { 294, 295, 65070 },
  { 112, 88, 22339 },
  { 88, 112, 22339 },
  { 112, 85, 60644 },
  { 85, 112, 60644 },
  { 88, 110, 70142 },
  { 110, 88, 70142 },
  { 110, 103, 56432 },
  { 103, 110, 56432 },
  { 116, 96, 53671 },
  { 96, 116, 53671 },
  { 14, 47, 106054 },
  { 47, 14, 106054 },
  { 296, 42, 36257 },
  { 42, 296, 36257 },
  { 20, 296, 13293 },
  { 296, 20, 13293 },
  { 19, 296, 12096 },
  { 296, 19, 12096 },
  { 20, 97, 122906 },
  { 97, 20, 122906 },
  { 47, 56, 11622 },
  { 56, 47, 11622 },
  { 56, 61, 54586 },
  { 61, 56, 54586 },
  { 131, 146, 18498 },
  { 146, 131, 18498 },
  { 118, 119, 17742 },
  { 119, 118, 17742 },
  { 118, 126, 33517 },
  { 126, 118, 33517 },
  { 184, 162, 40886 },
  { 162, 184, 40886 },
  { 162, 176, 35572 },
  { 176, 162, 35572 },
  { 176, 297, 12283 },
  { 297, 176, 12283 },
  { 297, 189, 522 },
  { 189, 297, 522 },
  { 230, 189, 8137 },
  { 189, 230, 8137 },
  { 230, 297, 7702 },
  { 297, 230, 7702 },
  { 228, 230, 29745 },
  { 230, 228, 29745 },
  { 196, 199, 13512 },
  { 199, 196, 13512 },
  { 173, 196, 32901 },
  { 196, 173, 32901 },
  { 198, 298, 2302 },
  { 298, 198, 2302 },
  { 199, 298, 3003 },
  { 298, 199, 3003 },
  { 298, 204, 36804 },
  { 204, 298, 36804 },
  { 204, 205, 3224 },
  { 205, 204, 3224 },
  { 193, 201, 45191 },
  { 201, 193, 45191 },
  { 199, 175, 51216 },
  { 175, 199, 51216 },
  { 201, 175, 32525 },
  { 175, 201, 32525 },
  { 143, 160, 48414 },
  { 160, 143, 48414 },
  { 220, 231, 29903 },
  { 231, 220, 29903 },
  { 225, 221, 5402 },
  { 221, 225, 5402 },
  { 148, 149, 2711 },
  { 149, 148, 2711 },
  { 149, 210, 76849 },
  { 210, 149, 76849 },
  { 153, 208, 2418 },
  { 208, 153, 2418 },
  { 210, 208, 35406 },
  { 208, 210, 35406 },
  { 222, 217, 2808 },
  { 217, 222, 2808 },
  { 222, 219, 5788 },
  { 219, 222, 5788 },
  { 216, 222, 3005 },
  { 222, 216, 3005 },
  { 219, 212, 4492 },
  { 212, 219, 4492 },
  { 215, 213, 1745 },
  { 213, 215, 1745 },
  { 212, 239, 15450 },
  { 239, 212, 15450 },
  { 214, 275, 2384 },
  { 275, 214, 2384 },
  { 275, 299, 852 },
  { 299, 275, 852 },
  { 299, 206, 3499 },
  { 206, 299, 3499 },
  { 233, 300, 27873 },
  { 300, 233, 27873 },
  { 188, 301, 35728 },
  { 301, 188, 35728 },
  { 301, 300, 2944 },
  { 300, 301, 2944 },
  { 187, 300, 35616 },
  { 300, 187, 35616 },
  { 302, 188, 3897 },
  { 188, 302, 3897 },
  { 153, 303, 169864 },
  { 303, 153, 169864 },
  { 303, 302, 7611 },
  { 302, 303, 7611 },
  { 302, 187, 3882 },
  { 187, 302, 3882 },
  { 181, 303, 71247 },
  { 303, 181, 71247 },
  { 207, 233, 44210 },
  { 233, 207, 44210 },
  { 253, 187, 69348 },
  { 187, 253, 69348 },
  { 253, 248, 30045 },
  { 248, 253, 30045 },
  { 182, 294, 122484 },
  { 294, 182, 122484 },
  { 182, 179, 1742 },
  { 179, 182, 1742 },
  { 272, 252, 9137 },
  { 252, 272, 9137 },
  { 251, 242, 47332 },
  { 242, 251, 47332 },
  { 205, 304, 75752 },
  { 304, 205, 75752 },
  { 305, 246, 67955 },
  { 246, 305, 67955 },
  { 273, 306, 2328 },
  { 306, 273, 2328 },
};

Edge hawaii[] = {
  { 0, 1, 6191 },
  { 1, 0, 6191 },
  { 2, 3, 4147 },
  { 3, 2, 4147 },
  { 4, 5, 3884 },
  { 5, 4, 3884 },
  { 5, 6, 1609 },
  { 6, 5, 1609 },
  { 7, 0, 12521 },
  { 0, 7, 12521 },
  { 8, 1, 2872 },
  { 1, 8, 2872 },
  { 9, 10, 4036 },
  { 10, 9, 4036 },
  { 4, 11, 2959 },
  { 11, 4, 2959 },
  { 12, 13, 27415 },
  { 13, 12, 27415 },
  { 14, 15, 6068 },
  { 15, 14, 6068 },
  { 15, 16, 7337 },
  { 16, 15, 7337 },
  { 17, 18, 2894 },
  { 18, 17, 2894 },
  { 18, 19, 5425 },
  { 19, 18, 5425 },
  { 20, 21, 2265 },
  { 21, 20, 2265 },
  { 19, 20, 3008 },
  { 20, 19, 3008 },
  { 21, 12, 6654 },
  { 12, 21, 6654 },
  { 22, 23, 1563 },
  { 23, 22, 1563 },
  { 23, 24, 3470 },
  { 24, 23, 3470 },
  { 25, 26, 6536 },
  { 26, 25, 6536 },
  { 27, 28, 10373 },
  { 28, 27, 10373 },
  { 28, 29, 7866 },
  { 29, 28, 7866 },
  { 29, 30, 8961 },
  { 30, 29, 8961 },
  { 31, 32, 6954 },
  { 32, 31, 6954 },
  { 33, 34, 24135 },
  { 34, 33, 24135 },
  { 34, 35, 5943 },
  { 35, 34, 5943 },
  { 33, 36, 2389 },
  { 36, 33, 2389 },
  { 35, 37, 3374 },
  { 37, 35, 3374 },
  { 34, 38, 4494 },
  { 38, 34, 4494 },
  { 37, 38, 8295 },
  { 38, 37, 8295 },
  { 38, 39, 12091 },
  { 39, 38, 12091 },
  { 39, 40, 4356 },
  { 40, 39, 4356 },
  { 39, 30, 3986 },
  { 30, 39, 3986 },
  { 29, 41, 3937 },
  { 41, 29, 3937 },
  { 41, 28, 7159 },
  { 28, 41, 7159 },
  { 42, 43, 3887 },
  { 43, 42, 3887 },
  { 43, 44, 3685 },
  { 44, 43, 3685 },
  { 43, 45, 20903 },
  { 45, 43, 20903 },
  { 45, 46, 2226 },
  { 46, 45, 2226 },
  { 47, 44, 7487 },
  { 44, 47, 7487 },
  { 44, 48, 22511 },
  { 48, 44, 22511 },
  { 46, 48, 7280 },
  { 48, 46, 7280 },
  { 48, 49, 3112 },
  { 49, 48, 3112 },
  { 49, 50, 2530 },
  { 50, 49, 2530 },
  { 50, 51, 17408 },
  { 51, 50, 17408 },
  { 45, 52, 15249 },
  { 52, 45, 15249 },
  { 53, 54, 36470 },
  { 54, 53, 36470 },
  { 54, 49, 7694 },
  { 49, 54, 7694 },
  { 51, 55, 11400 },
  { 55, 51, 11400 },
  { 52, 46, 15473 },
  { 46, 52, 15473 },
  { 55, 56, 37433 },
  { 56, 55, 37433 },
  { 53, 57, 3855 },
  { 57, 53, 3855 },
  { 57, 58, 1508 },
  { 58, 57, 1508 },
  { 59, 60, 3574 },
  { 60, 59, 3574 },
  { 59, 53, 7377 },
  { 53, 59, 7377 },
  { 58, 60, 6801 },
  { 60, 58, 6801 },
  { 60, 61, 9191 },
  { 61, 60, 9191 },
  { 61, 62, 3940 },
  { 62, 61, 3940 },
  { 62, 63, 1941 },
  { 63, 62, 1941 },
  { 63, 64, 17861 },
  { 64, 63, 17861 },
  { 65, 66, 12138 },
  { 66, 65, 12138 },
  { 66, 67, 5764 },
  { 67, 66, 5764 },
  { 68, 62, 2365 },
  { 62, 68, 2365 },
  { 69, 70, 14756 },
  { 70, 69, 14756 },
  { 70, 71, 3931 },
  { 71, 70, 3931 },
  { 71, 72, 6955 },
  { 72, 71, 6955 },
  { 69, 73, 4265 },
  { 73, 69, 4265 },
  { 73, 56, 5278 },
  { 56, 73, 5278 },
  { 74, 75, 1088 },
  { 75, 74, 1088 },
  { 76, 77, 2549 },
  { 77, 76, 2549 },
  { 78, 79, 2029 },
  { 79, 78, 2029 },
  { 80, 81, 4607 },
  { 81, 80, 4607 },
  { 81, 82, 995 },
  { 82, 81, 995 },
  { 82, 83, 5708 },
  { 83, 82, 5708 },
  { 83, 84, 1015 },
  { 84, 83, 1015 },
  { 85, 86, 2592 },
  { 86, 85, 2592 },
  { 86, 75, 9272 },
  { 75, 86, 9272 },
  { 86, 87, 1549 },
  { 87, 86, 1549 },
  { 87, 88, 1155 },
  { 88, 87, 1155 },
  { 85, 84, 8375 },
  { 84, 85, 8375 },
  { 84, 89, 3022 },
  { 89, 84, 3022 },
  { 89, 90, 6455 },
  { 90, 89, 6455 },
  { 80, 91, 2912 },
  { 91, 80, 2912 },
  { 78, 92, 2087 },
  { 92, 78, 2087 },
  { 91, 76, 7736 },
  { 76, 91, 7736 },
  { 88, 85, 2143 },
  { 85, 88, 2143 },
  { 93, 8, 9507 },
  { 8, 93, 9507 },
  { 89, 88, 9385 },
  { 88, 89, 9385 },
  { 64, 65, 24795 },
  { 65, 64, 24795 },
  { 54, 94, 32035 },
  { 94, 54, 32035 },
  { 94, 56, 35025 },
  { 56, 94, 35025 },
  { 69, 95, 25243 },
  { 95, 69, 25243 },
  { 67, 96, 30757 },
  { 96, 67, 30757 },
  { 96, 97, 859 },
  { 97, 96, 859 },
  { 97, 95, 3230 },
  { 95, 97, 3230 },
  { 1, 9, 16155 },
  { 9, 1, 16155 },
  { 98, 51, 11706 },
  { 51, 98, 11706 },
  { 75, 99, 51590 },
  { 99, 75, 51590 },
  { 11, 100, 23417 },
  { 100, 11, 23417 },
  { 100, 101, 12368 },
  { 101, 100, 12368 },
  { 102, 103, 4846 },
  { 103, 102, 4846 },
  { 103, 104, 2901 },
  { 104, 103, 2901 },
  { 10, 104, 7849 },
  { 104, 10, 7849 },
  { 104, 2, 2147 },
  { 2, 104, 2147 },
  { 2, 102, 1761 },
  { 102, 2, 1761 },
  { 102, 4, 4444 },
  { 4, 102, 4444 },
  { 74, 105, 8183 },
  { 105, 74, 8183 },
  { 106, 107, 7075 },
  { 107, 106, 7075 },
  { 89, 107, 1178 },
  { 107, 89, 1178 },
  { 108, 81, 1312 },
  { 81, 108, 1312 },
  { 81, 109, 1793 },
  { 109, 81, 1793 },
  { 82, 108, 1001 },
  { 108, 82, 1001 },
  { 108, 80, 7421 },
  { 80, 108, 7421 },
  { 110, 92, 434 },
  { 92, 110, 434 },
  { 92, 79, 3285 },
  { 79, 92, 3285 },
  { 79, 99, 2706 },
  { 99, 79, 2706 },
  { 111, 78, 3052 },
  { 78, 111, 3052 },
  { 77, 111, 2036 },
  { 111, 77, 2036 },
  { 24, 25, 2634 },
  { 25, 24, 2634 },
  { 25, 21, 1832 },
  { 21, 25, 1832 },
  { 33, 112, 14461 },
  { 112, 33, 14461 },
  { 113, 114, 7998 },
  { 114, 113, 7998 },
  { 41, 115, 6937 },
  { 115, 41, 6937 },
  { 32, 116, 47595 },
  { 116, 32, 47595 },
  { 99, 117, 3887 },
  { 117, 99, 3887 },
  { 117, 118, 736 },
  { 118, 117, 736 },
  { 85, 83, 9281 },
  { 83, 85, 9281 },
  { 118, 80, 4823 },
  { 80, 118, 4823 },
  { 77, 119, 22341 },
  { 119, 77, 22341 },
  { 56, 120, 1612 },
  { 120, 56, 1612 },
  { 79, 121, 3258 },
  { 121, 79, 3258 },
  { 52, 57, 25357 },
  { 57, 52, 25357 },
  { 99, 121, 1646 },
  { 121, 99, 1646 },
  { 121, 76, 1359 },
  { 76, 121, 1359 },
  { 37, 27, 3890 },
  { 27, 37, 3890 },
  { 27, 31, 5066 },
  { 31, 27, 5066 },
  { 122, 123, 2556 },
  { 123, 122, 2556 },
  { 90, 122, 947 },
  { 122, 90, 947 },
  { 122, 124, 911 },
  { 124, 122, 911 },
  { 124, 125, 23829 },
  { 125, 124, 23829 },
  { 91, 119, 7911 },
  { 119, 91, 7911 },
};

const mpq_class&
perturbate(unsigned long a) {
  //static mpq_class q = a;
  static mpq_class q;
  q = a;
  q = (q*q)/(q-1);
  return q;
}

void
add_edges(BD_Shape<mpq_class>& bd, const Edge* edges, unsigned n) {
  for (unsigned i = 0; i < n; ++i) {
    const mpq_class& q = perturbate(edges[i].distance);
    Coefficient a;
    assign(a, q.get_den(), ROUND_IGNORE);
    Coefficient b;
    assign(b, q.get_num(), ROUND_IGNORE);
#if NOISY
    cout << "a = " << a << "; b = " << b << endl;
#endif
    bd.add_constraint(a*Variable(edges[i].from) - a*Variable(edges[i].to)
		      <= b);
  }
}

} // namespace

int
main() TRY {
  // BD_Shape<mpq_class> bd(307);

  BD_Shape<mpq_class> bd(126);
  add_edges(bd, hawaii, sizeof(hawaii)/sizeof(Edge));

  // Force closure.
  (void) bd.is_empty();

  using namespace Parma_Polyhedra_Library::IO_Operators;

  cout << bd << endl;

  return 0;
}
CATCH
